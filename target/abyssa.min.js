/* abyssa 7.0.0 - A stateful router library for single page applications */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Abyssa=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c){!function(){var d=function(a){function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function c(a,c){var d=b(a,c);-1!==d&&a.splice(d,1)}function d(a,b){return"[object "+b+"]"===Object.prototype.toString.call(a)}function e(a){return d(a,"RegExp")}function f(a){return d(a,"Array")}function g(a){return"function"==typeof a}function h(a){var b;return b=null===a||"null"===a?null:"true"===a?!0:"false"===a?!1:a===o||"undefined"===a?o:""===a||isNaN(a)?a:parseFloat(a)}function i(a){for(var b=a.length,c=[];b--;)c[b]=h(a[b]);return c}function j(a,b){for(var c,d,e=(a||"").replace("?","").split("&"),f=e.length,g={};f--;)c=e[f].split("="),d=b?h(c[1]):c[1],g[c[0]]="string"==typeof d?decodeURIComponent(d):d;return g}function k(){this.bypassed=new a.Signal,this.routed=new a.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function l(b,c,d,f){var g=e(b),h=f.patternLexer;this._router=f,this._pattern=b,this._paramsIds=g?null:h.getParamIds(b),this._optionalParamsIds=g?null:h.getOptionalParamsIds(b),this._matchRegexp=g?b:h.compilePattern(b,f.ignoreCase),this.matched=new a.Signal,this.switched=new a.Signal,c&&this.matched.add(c),this._priority=d||0}var m,n,o;return n=""===/t(.+)?/.exec("t")[1],k.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new k},addRoute:function(a,b,c){var d=new l(a,b,c,this);return this._sortedInsert(d),d},removeRoute:function(a){c(this._routes,a),a._destroy()},removeAllRoutes:function(){for(var a=this.getNumRoutes();a--;)this._routes[a]._destroy();this._routes.length=0},parse:function(a,b){if(a=a||"",b=b||[],this.ignoreState||a!==this._prevMatchedRequest&&a!==this._prevBypassedRequest){var c,d=this._getMatchedRoutes(a),e=0,f=d.length;if(f)for(this._prevMatchedRequest=a,this._notifyPrevRoutes(d,a),this._prevRoutes=d;f>e;)c=d[e],c.route.matched.dispatch.apply(c.route.matched,b.concat(c.params)),c.isFirst=!e,this.routed.dispatch.apply(this.routed,b.concat([a,c])),e+=1;else this._prevBypassedRequest=a,this.bypassed.dispatch.apply(this.bypassed,b.concat([a]));this._pipeParse(a,b)}},_notifyPrevRoutes:function(a,b){for(var c,d=0;c=this._prevRoutes[d++];)c.route.switched&&this._didSwitch(c.route,a)&&c.route.switched.dispatch(b)},_didSwitch:function(a,b){for(var c,d=0;c=b[d++];)if(c.route===a)return!1;return!0},_pipeParse:function(a,b){for(var c,d=0;c=this._piped[d++];)c.parse(a,b)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(a){var b=this._routes,c=b.length;do--c;while(b[c]&&a._priority<=b[c]._priority);b.splice(c+1,0,a)},_getMatchedRoutes:function(a){for(var b,c=[],d=this._routes,e=d.length;(b=d[--e])&&((!c.length||this.greedy||b.greedy)&&b.match(a)&&c.push({route:b,params:b._getParamsArray(a)}),this.greedyEnabled||!c.length););return c},pipe:function(a){this._piped.push(a)},unpipe:function(a){c(this._piped,a)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},m=new k,m.VERSION="0.12.0",m.NORM_AS_ARRAY=function(a,b){return[b.vals_]},m.NORM_AS_OBJECT=function(a,b){return[b]},l.prototype={greedy:!1,rules:void 0,match:function(a){return a=a||"",this._matchRegexp.test(a)&&this._validateParams(a)},_validateParams:function(a){var b,c=this.rules,d=this._getParamsObject(a);for(b in c)if("normalize_"!==b&&c.hasOwnProperty(b)&&!this._isValidParam(a,b,d))return!1;return!0},_isValidParam:function(a,c,d){var h=this.rules[c],i=d[c],j=!1,k=0===c.indexOf("?");return null==i&&this._optionalParamsIds&&-1!==b(this._optionalParamsIds,c)?j=!0:e(h)?(k&&(i=d[c+"_"]),j=h.test(i)):f(h)?(k&&(i=d[c+"_"]),j=this._isValidArrayRule(h,i)):g(h)&&(j=h(i,a,d)),j},_isValidArrayRule:function(a,c){if(!this._router.ignoreCase)return-1!==b(a,c);"string"==typeof c&&(c=c.toLowerCase());for(var d,e,f=a.length;f--;)if(d=a[f],e="string"==typeof d?d.toLowerCase():d,e===c)return!0;return!1},_getParamsObject:function(a){for(var c,d,e=this._router.shouldTypecast,f=this._router.patternLexer.getParamValues(a,this._matchRegexp,e),g={},i=f.length;i--;)d=f[i],this._paramsIds&&(c=this._paramsIds[i],0===c.indexOf("?")&&d&&(g[c+"_"]=d,d=j(d,e),f[i]=d),n&&""===d&&-1!==b(this._optionalParamsIds,c)&&(d=void 0,f[i]=d),g[c]=d),g[i]=d;return g.request_=e?h(a):a,g.vals_=f,g},_getParamsArray:function(a){var b,c=this.rules?this.rules.normalize_:null;return c=c||this._router.normalizeFn,b=c&&g(c)?c(a,this._getParamsObject(a)):this._getParamsObject(a).vals_},interpolate:function(a){var b=this._router.patternLexer.interpolate(this._pattern,a);if(!this._validateParams(b))throw new Error("Generated string doesn't validate against `Route.rules`.");return b},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},k.prototype.patternLexer=function(){function a(){var a,b;for(a in n)n.hasOwnProperty(a)&&(b=n[a],b.id="__CR_"+a+"__",b.save="save"in b?b.save.replace("{{id}}",b.id):b.id,b.rRestore=new RegExp(b.id,"g"))}function b(a,b){var c,d=[];for(a.lastIndex=0;c=a.exec(b);)d.push(c[1]);return d}function c(a){return b(m,a)}function d(a){return b(n.OP.rgx,a)}function e(a,b){return a=a||"",a&&(r===o?a=a.replace(k,""):r===q&&(a=a.replace(l,"")),a=f(a,"rgx","save"),a=a.replace(j,"\\$&"),a=f(a,"rRestore","res"),r===o&&(a="\\/?"+a)),r!==p&&(a+="\\/?"),new RegExp("^"+a+"$",b?"i":"")}function f(a,b,c){var d,e;for(e in n)n.hasOwnProperty(e)&&(d=n[e],a=a.replace(d[b],d[c]));return a}function g(a,b,c){var d=b.exec(a);return d&&(d.shift(),c&&(d=i(d))),d}function h(a,b){if("string"!=typeof a)throw new Error("Route pattern should be a string.");var c=function(a,c){var d;if(c="?"===c.substr(0,1)?c.substr(1):c,null!=b[c]){if("object"==typeof b[c]){var e=[];for(var f in b[c])e.push(encodeURI(f+"="+b[c][f]));d="?"+e.join("&")}else d=String(b[c]);if(-1===a.indexOf("*")&&-1!==d.indexOf("/"))throw new Error('Invalid value "'+d+'" for segment "'+a+'".')}else{if(-1!==a.indexOf("{"))throw new Error("The segment "+a+" is required.");d=""}return d};return n.OS.trail||(n.OS.trail=new RegExp("(?:"+n.OS.id+")+$")),a.replace(n.OS.rgx,n.OS.save).replace(m,c).replace(n.OS.trail,"").replace(n.OS.rRestore,"/")}var j=/[\\.+*?\^$\[\](){}\/'#]/g,k=/^\/|\/$/g,l=/\/$/g,m=/(?:\{|:)([^}:]+)(?:\}|:)/g,n={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},o=1,p=2,q=3,r=o;return a(),{strict:function(){r=p},loose:function(){r=o},legacy:function(){r=q},getParamIds:c,getOptionalParamsIds:d,getParamValues:g,compilePattern:e,interpolate:h}}(),m};"function"==typeof a&&a.amd?a(["signals"],d):"undefined"!=typeof c&&c.exports?c.exports=d(b("signals")):window.crossroads=d(window.signals)}()},{signals:2}],2:[function(b,c){!function(b){function d(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function e(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function f(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){f.prototype.dispatch.apply(a,arguments)}}d.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},f.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,e){var f,g=this._indexOfListener(a,c);if(-1!==g){if(f=this._bindings[g],f.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else f=new d(this,a,b,c,e),this._addBinding(f);return this.memorize&&this._prevParams&&f.execute(this._prevParams),f},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){return e(a,"add"),this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return e(a,"addOnce"),this._registerListener(a,!0,b,c)},remove:function(a,b){e(a,"remove");var c=this._indexOfListener(a,b);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var a,b=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=b),c){a=this._bindings.slice(),this._shouldPropagate=!0;do c--;while(a[c]&&this._shouldPropagate&&a[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var g=f;g.Signal=f,"function"==typeof a&&a.amd?a(function(){return g}):"undefined"!=typeof c&&c.exports?c.exports=g:b.signals=g}(this)},{}],3:[function(a,b){"use strict";function c(a){function b(a,b,c){var d=i.objectDiff(V&&V.params,b);if(c||!o(a,d)){var e,f=g(a,b);X?(k(),e=g(X.currentState,X.toParams)):e=V,W=V,V=f,gb=d,X=h(e,f,d,c,j),l(e,f),X&&(X.start(),m(e,f,c))}}function k(){j.log("Cancelling existing transition from {0} to {1}",X.from,X.to),X.cancel(),db=!1}function l(a,b){j.log("Starting transition from {0} to {1}",a,b),ab.transition.started.dispatch(b,a)}function m(a,b,c){Z||db||c||(j.log("Updating URL: {0}",U),n(U,document.title,U)),X=null,db=!1,ab.flash=null,j.log("Transition from {0} to {1} ended",a,b),b.state.lastParams=b.params,ab.transition.ended.dispatch(b,a)}function n(a,b,c){eb.urlSync&&(G()?(fb=!0,location.hash=eb.hashPrefix+c):history.pushState(a,b,c))}function o(a,b){return V?a==V.state&&0==i.objectSize(b.all):!1}function p(a){if(j.log("State not found: {0}",a),eb.notFound)return b(Y[eb.notFound]||eb.notFound,{});throw new Error('State "'+a+'" could not be found')}function q(a){return i.mergeObjects(eb,a),ab}function r(a,b){return eb.enableLogs&&c.enableLogs(),eb.interceptAnchors&&f(ab),eb.shouldTypecast&&(cb.shouldTypecast=!0),_="#"+eb.hashPrefix+"/",j.log("Router init"),v(),T(),a=void 0!==a?a:u(),j.log("Initializing to state {0}",a||'""'),y(a,b),t(),$=!0,ab}function s(){window.onhashchange=null,window.onpopstate=null}function t(){function a(a){if(fb)return void(fb=!1);var b=G()?F():a.state;j.log("URL changed: {0}",b),Z=!0,C(b)}eb.urlSync&&(window[G()?"onhashchange":"onpopstate"]=a)}function u(){return eb.urlSync?F():""}function v(){w(function(a,b){b.init(ab,a)}),eb.notFound&&eb.notFound.init&&eb.notFound.init("notFound"),Y={},x(bb)}function w(a){for(var b in bb)a(b,bb[b])}function x(a){function b(a){a.forEach(function(a){a.children.length?b(a.children):c(a)})}function c(a){Y[a.fullName]=a;var b=cb.addRoute(a.fullPath()+":?query:");a.route=b,b.abyssaState=a}b(i.objectToArray(a))}function y(a){var b=void 0!==Y[a],c=b?arguments[1]:null,d=b?arguments[2]:arguments[1];if(j.log("Changing state to {0}",a||'""'),i.isPlainObject(ab.flash)&&i.isPlainObject(d)){var e={};i.mergeObjects(e,ab.flash),i.mergeObjects(e,d),d=e}ab.flash=d,Z=!1,b?D(a,c||{}):C(a)}function z(){j.log("Redirecting..."),y.apply(null,arguments)}function A(a,b,c){var d=Y[a].lastParams||b;y(a,d,c)}function B(){return b(V.state,V.params,!0)}function C(a){function c(a,b){d=b}var d;U=i.normalizePathQuery(a),cb.routed.add(c),cb.parse(U),cb.routed.remove(c),d?b(d.route.abyssaState,H(d.route.abyssaState,d.params)):p(U)}function D(a,b){var c=Y[a];if(!c)return p(a);var d=K(c,b);C(d)}function E(a,b){if(bb[a])throw new Error("A state already exist in the router with the name "+a);return bb[a]=b,$&&(b.init(ab,a),x({name:b})),ab}function F(){var a,b=location.href.indexOf(_);return a=b>-1?location.href.slice(b+_.length):G()?"/":(location.pathname+location.search).slice(1),i.normalizePathQuery(a)}function G(){return"hash"==eb.urlSync}function H(a,b){var c,d=Array.prototype.slice.apply(b),e=d.pop(),f={};a.fullPath().replace(hb,function(a){return c=a.slice(1,-1),f[c]=d.shift(),""}),a.fullPath().replace(ib,function(a){c=a.slice(1,-2),f[c]=d.shift()}),e&&i.mergeObjects(f,e);for(var g in f)i.isString(f[g])&&(f[g]=decodeURIComponent(f[g]));return f}function I(a,b){var c={},d=a.allQueryParams();for(var e in b)d[e]?(c.query=c.query||{},c.query[e]=b[e]):c[e]=b[e];return c}function J(a,b){var c=Y[a];if(!c)throw new Error("Cannot find state "+a);var d=K(c,b);return i.normalizePathQuery(d)}function K(a,b){var c={};for(var d in b)c[d]=encodeURIComponent(b[d]);var e=I(a,c),f=a.route.interpolate(e),g=f.split("?"),h=g[0],i=g[1];return f=h+(i?"?"+decodeURI(i):"")}function L(){return V}function M(){return W}function N(){return U.split("?")[0]}function O(){return U.split("?")[1]}function P(){return i.copyObject(V.params)}function Q(){var a=V.state.allQueryParams(),b=V.params,c={};for(var d in b)d in a&&(c[d]=b[d]);return c}function R(){return gb}function S(){return null==W}function T(){if(j.enabled){var a=function(a){return 0==a?"":new Array(2+4*(a-1)).join(" ")+"── "},b=function(c){var d=i.normalizePathQuery(c.fullPath()),e=0==c.children.length?" (@ path)".replace("path",d):"",f=a(c.parents.length)+c.name+e+"\n";return f+c.children.map(b).join("")},c="\nState tree\n\n";c+=i.objectToArray(bb).map(b).join(""),c+="\n",j.log(c)}}var U,V,W,X,Y,Z,$,_,ab={},bb=i.copyObject(a),cb=e.create(),db=!0,eb={enableLogs:!1,interceptAnchors:!0,shouldTypecast:!0,notFound:null,urlSync:!0,hashPrefix:""},fb=!1,gb={};cb.ignoreState=!0;var hb=/\{\w*\}/g,ib=/:\w*\*:/;return ab.configure=q,ab.init=r,ab.state=y,ab.redirect=z,ab.backTo=A,ab.reload=B,ab.addState=E,ab.link=J,ab.currentState=L,ab.previousState=M,ab.isFirstTransition=S,ab.path=N,ab.query=O,ab.params=P,ab.queryParams=Q,ab.paramsDiff=R,ab.urlPathQuery=F,ab.terminate=s,ab.transition={started:new d,ended:new d},ab.changed=ab.transition.completed,ab}var d=a("signals").Signal,e=a("crossroads"),f=a("./anchors"),g=a("./StateWithParams"),h=a("./Transition"),i=a("./util"),j={log:i.noop,error:i.noop,enabled:!1};c.enableLogs=function(){j.enabled=!0,j.log=function(){var a=i.makeMessage.apply(null,arguments);console.log(a)},j.error=function(){var a=i.makeMessage.apply(null,arguments);console.error(a)}},b.exports=c},{"./StateWithParams":5,"./Transition":6,"./anchors":7,"./util":9,crossroads:1,signals:2}],4:[function(a,b){"use strict";function c(){function a(a,b,d){o.router=a,o.name=b,o.parent=d,o.parents=c(),o.root=o.parent?o.parents[o.parents.length-1]:o,o.children=f(),o.fullName=h(),o.root=o.parents[o.parents.length-1],k(function(b,c){c.init(a,b,o)}),n=!0}function b(){for(var a=o.path,b=o.parent;b;)b.path&&(a=b.path+"/"+a),b=b.parent;return a}function c(){for(var a=[],b=o.parent;b;)a.push(b),b=b.parent;return a}function f(){var a=[];for(var b in r)a.push(r[b]);return a}function g(a){var b={};for(var c in a)a[c]._isState&&(b[c]=a[c]);return b}function h(){return o.parents.reduceRight(function(a,b){return a+b.name+"."},"")+o.name}function i(){return o.parents.reduce(function(a,b){return e.mergeObjects(a,b.queryParams)},e.copyObject(o.queryParams))}function j(a,b){if(void 0!==b)return o.ownData[a]=b,o;for(var c=o;void 0===c.ownData[a]&&c.parent;)c=c.parent;return c.ownData[a]}function k(a){for(var b in r)a(b,r[b])}function l(a,b){if(n)throw new Error("States can only be added before the Router is initialized");if(r[a])throw new Error("The state {0} already has a child state named {1}".replace("{0}",o.name).replace("{1}",a));return r[a]=b,o}function m(){return o.fullName}var n,o={_isState:!0},p=d(arguments),q=p.options,r=g(p.options);return o.path=p.path,o.params=p.params,o.queryParams=p.queryParams,o.states=r,o.enter=q.enter||e.noop,o.update=q.update,o.exit=q.exit||e.noop,o.ownData=q.data||{},o.init=a,o.fullPath=b,o.allQueryParams=i,o.data=j,o.addState=l,o.toString=m,o}function d(a){var b,c,d={path:"",options:{},params:{},queryParams:{}},f=a[0],g=a[1];return 1==a.length?e.isString(f)?d.path=f:d.options=f:2==a.length&&(d.path=f,d.options="object"==typeof g?g:{enter:g}),b=d.path.indexOf("?"),-1!=b&&(d.queryParams=d.path.slice(b+1),d.path=d.path.slice(0,b),d.queryParams=e.arrayToObject(d.queryParams.split("&"))),d.path=d.path.replace(/:[^\\?\/]*/g,function(a){var b;return c=a.substring(1),"*"==c[c.length-1]&&(c=c.slice(0,-1),b=!0),d.params[c]=1,b?":"+c+"*:":"{"+c+"}"}),d}var e=a("./util");b.exports=c},{"./util":9}],5:[function(a,b){"use strict";function c(a,b){return{state:a,params:b,isIn:d,toString:e}}function d(a){for(var b=this.state;b;){if(b.fullName==a)return!0;b=b.parent}return!1}function e(){return(this.state?this.state.fullName:void 0)+":"+JSON.stringify(this.params)}b.exports=c},{}],6:[function(a,b){"use strict";function c(a,b,c,f,h){function j(){d(r,f,c)||e(m,n,q,t,s,h)}function k(){t.cancelled=!0}var l,m,n=[],o=a&&a.state,p=b.state,q=b.params,r=o==p,s=r&&!f,t={from:o,to:p,toParams:q,cancel:k,cancelled:!1,currentState:o,start:j};return o&&(l=f?p.root:g(o,p,r,c),n=i(o,l,r)),m=i(p,l,r).reverse(),t}function d(a,b,c){return a&&!b&&0==j.objectSize(c.all)}function e(a,b,c,d,e,g){b.forEach(function(a){e&&a.update||f(a,"exit",c,d,g)}),a.forEach(function(a){var b=e&&a.update?"update":"enter";f(a,b,c,d,g)})}function f(a,b,c,d,e){if(!d.cancelled){if(e.enabled){var f=b[0].toUpperCase()+b.slice(1);e.log(f+" "+a.fullName)}var g=a[b](c);if(!d.cancelled)return d.currentState="exit"==b?a.parent:a,g}}function g(a,b,c,d){var e,f,g;if(c)[a].concat(a.parents).reverse().forEach(function(a){if(!e)for(g in d.all)if(a.params[g]||a.queryParams[g]){e=a;break}});else for(var h=0;h<a.parents.length;h++)if(f=a.parents[h],b.parents.indexOf(f)>-1){e=f;break}return e}function h(a,b,c){var d=a.parents,e=Math.min(d.length,d.indexOf(b)+(c?1:0));return[a].concat(d.slice(0,e))}function i(a,b,c){var d=!b||c;return h(a,b||a.root,d)}var j=a("./util");b.exports=c},{"./util":9}],7:[function(a,b){"use strict";function c(a){var b=e(a);void 0!==b&&i.state(b)}function d(a){var b=e(a);void 0!==b&&(a.preventDefault(),i.state(b))}function e(a){if(!(a.defaultPrevented||a.metaKey||a.ctrlKey)&&f(a)){var b=a.target,c=g(b);if(c){var d=c.getAttribute("data-nav");if("ignore"!=d&&("mousedown"!=a.type||"mousedown"==d)){var e=c.getAttribute("href");if(e&&"#"!=e.charAt(0)&&"_blank"!=c.getAttribute("target")&&h(c))return"click"==a.type&&"mousedown"==d?void a.preventDefault():e}}}}function f(a){return 1==a.which}function g(a){for(;a;){if("A"==a.nodeName)return a;a=a.parentNode}}function h(a){var b=a.hostname,c=a.port;if(!b){var d=document.createElement("a");d.href=a.href,b=d.hostname,c=d.port}var e=b==location.hostname,f=(c||"80")==(location.port||"80");return e&&f}var i;b.exports=function(a){i=a,document.addEventListener("mousedown",c),document.addEventListener("click",d)}},{}],8:[function(a,b){"use strict";var c={Router:a("./Router"),State:a("./State"),util:a("./util")};b.exports=c},{"./Router":3,"./State":4,"./util":9}],9:[function(a,b){"use strict";function c(a){return"[object String]"==Object.prototype.toString.call(a)}function d(){}function e(a){return a.reduce(function(a,b){return a[b]=1,a},{})}function f(a){var b=[];for(var c in a)b.push(a[c]);return b}function g(a){var b={};for(var c in a)b[c]=a[c];return b}function h(a,b){for(var c in b)a[c]=b[c];return a}function i(a){return a&&a.constructor===Object}function j(a){var b=0;for(var c in a)b++;return b}function k(a,b){var c,d,e={},f={},g={},h={},a=a||{};for(d in a)d in b?a[d]!=b[d]&&(e[d]=h[d]=!0):g[d]=h[d]=!0;for(d in b)d in a||(f[d]=h[d]=!0);return c={all:h,update:e,enter:f,exit:g}}function l(){for(var a=arguments[0],b=Array.prototype.slice.call(arguments,1),c=0,d=b.length;d>c;c++)a=a.replace("{"+c+"}",b[c]);return a}function m(a){return"/"+a.replace(n,"").replace(o,"$1").replace(p,"?")}var n=/^\/+/,o=/^([^?]*?)\/+$/,p=/\/+\?/;b.exports={isString:c,noop:d,arrayToObject:e,objectToArray:f,copyObject:g,mergeObjects:h,isPlainObject:i,objectSize:j,makeMessage:l,normalizePathQuery:m,objectDiff:k}},{}]},{},[8])(8)});