/* abyssa 1.5.1 - A stateful router library for single page applications */

!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.Abyssa=a():"undefined"!=typeof global?global.Abyssa=a():"undefined"!=typeof self&&(self.Abyssa=a())}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c){!function(){var d=function(a){function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function c(a,c){var d=b(a,c);-1!==d&&a.splice(d,1)}function d(a,b){return"[object "+b+"]"===Object.prototype.toString.call(a)}function e(a){return d(a,"RegExp")}function f(a){return d(a,"Array")}function g(a){return"function"==typeof a}function h(a){var b;return b=null===a||"null"===a?null:"true"===a?!0:"false"===a?!1:a===o||"undefined"===a?o:""===a||isNaN(a)?a:parseFloat(a)}function i(a){for(var b=a.length,c=[];b--;)c[b]=h(a[b]);return c}function j(a,b){for(var c,d,e=(a||"").replace("?","").split("&"),f=e.length,g={};f--;)c=e[f].split("="),d=b?h(c[1]):c[1],g[c[0]]="string"==typeof d?decodeURIComponent(d):d;return g}function k(){this.bypassed=new a.Signal,this.routed=new a.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function l(b,c,d,f){var g=e(b),h=f.patternLexer;this._router=f,this._pattern=b,this._paramsIds=g?null:h.getParamIds(b),this._optionalParamsIds=g?null:h.getOptionalParamsIds(b),this._matchRegexp=g?b:h.compilePattern(b,f.ignoreCase),this.matched=new a.Signal,this.switched=new a.Signal,c&&this.matched.add(c),this._priority=d||0}var m,n,o;return n=""===/t(.+)?/.exec("t")[1],k.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new k},addRoute:function(a,b,c){var d=new l(a,b,c,this);return this._sortedInsert(d),d},removeRoute:function(a){c(this._routes,a),a._destroy()},removeAllRoutes:function(){for(var a=this.getNumRoutes();a--;)this._routes[a]._destroy();this._routes.length=0},parse:function(a,b){if(a=a||"",b=b||[],this.ignoreState||a!==this._prevMatchedRequest&&a!==this._prevBypassedRequest){var c,d=this._getMatchedRoutes(a),e=0,f=d.length;if(f)for(this._prevMatchedRequest=a,this._notifyPrevRoutes(d,a),this._prevRoutes=d;f>e;)c=d[e],c.route.matched.dispatch.apply(c.route.matched,b.concat(c.params)),c.isFirst=!e,this.routed.dispatch.apply(this.routed,b.concat([a,c])),e+=1;else this._prevBypassedRequest=a,this.bypassed.dispatch.apply(this.bypassed,b.concat([a]));this._pipeParse(a,b)}},_notifyPrevRoutes:function(a,b){for(var c,d=0;c=this._prevRoutes[d++];)c.route.switched&&this._didSwitch(c.route,a)&&c.route.switched.dispatch(b)},_didSwitch:function(a,b){for(var c,d=0;c=b[d++];)if(c.route===a)return!1;return!0},_pipeParse:function(a,b){for(var c,d=0;c=this._piped[d++];)c.parse(a,b)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(a){var b=this._routes,c=b.length;do--c;while(b[c]&&a._priority<=b[c]._priority);b.splice(c+1,0,a)},_getMatchedRoutes:function(a){for(var b,c=[],d=this._routes,e=d.length;(b=d[--e])&&((!c.length||this.greedy||b.greedy)&&b.match(a)&&c.push({route:b,params:b._getParamsArray(a)}),this.greedyEnabled||!c.length););return c},pipe:function(a){this._piped.push(a)},unpipe:function(a){c(this._piped,a)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},m=new k,m.VERSION="0.12.0",m.NORM_AS_ARRAY=function(a,b){return[b.vals_]},m.NORM_AS_OBJECT=function(a,b){return[b]},l.prototype={greedy:!1,rules:void 0,match:function(a){return a=a||"",this._matchRegexp.test(a)&&this._validateParams(a)},_validateParams:function(a){var b,c=this.rules,d=this._getParamsObject(a);for(b in c)if("normalize_"!==b&&c.hasOwnProperty(b)&&!this._isValidParam(a,b,d))return!1;return!0},_isValidParam:function(a,c,d){var h=this.rules[c],i=d[c],j=!1,k=0===c.indexOf("?");return null==i&&this._optionalParamsIds&&-1!==b(this._optionalParamsIds,c)?j=!0:e(h)?(k&&(i=d[c+"_"]),j=h.test(i)):f(h)?(k&&(i=d[c+"_"]),j=this._isValidArrayRule(h,i)):g(h)&&(j=h(i,a,d)),j},_isValidArrayRule:function(a,c){if(!this._router.ignoreCase)return-1!==b(a,c);"string"==typeof c&&(c=c.toLowerCase());for(var d,e,f=a.length;f--;)if(d=a[f],e="string"==typeof d?d.toLowerCase():d,e===c)return!0;return!1},_getParamsObject:function(a){for(var c,d,e=this._router.shouldTypecast,f=this._router.patternLexer.getParamValues(a,this._matchRegexp,e),g={},i=f.length;i--;)d=f[i],this._paramsIds&&(c=this._paramsIds[i],0===c.indexOf("?")&&d&&(g[c+"_"]=d,d=j(d,e),f[i]=d),n&&""===d&&-1!==b(this._optionalParamsIds,c)&&(d=void 0,f[i]=d),g[c]=d),g[i]=d;return g.request_=e?h(a):a,g.vals_=f,g},_getParamsArray:function(a){var b,c=this.rules?this.rules.normalize_:null;return c=c||this._router.normalizeFn,b=c&&g(c)?c(a,this._getParamsObject(a)):this._getParamsObject(a).vals_},interpolate:function(a){var b=this._router.patternLexer.interpolate(this._pattern,a);if(!this._validateParams(b))throw new Error("Generated string doesn't validate against `Route.rules`.");return b},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},k.prototype.patternLexer=function(){function a(){var a,b;for(a in n)n.hasOwnProperty(a)&&(b=n[a],b.id="__CR_"+a+"__",b.save="save"in b?b.save.replace("{{id}}",b.id):b.id,b.rRestore=new RegExp(b.id,"g"))}function b(a,b){var c,d=[];for(a.lastIndex=0;c=a.exec(b);)d.push(c[1]);return d}function c(a){return b(m,a)}function d(a){return b(n.OP.rgx,a)}function e(a,b){return a=a||"",a&&(r===o?a=a.replace(k,""):r===q&&(a=a.replace(l,"")),a=f(a,"rgx","save"),a=a.replace(j,"\\$&"),a=f(a,"rRestore","res"),r===o&&(a="\\/?"+a)),r!==p&&(a+="\\/?"),new RegExp("^"+a+"$",b?"i":"")}function f(a,b,c){var d,e;for(e in n)n.hasOwnProperty(e)&&(d=n[e],a=a.replace(d[b],d[c]));return a}function g(a,b,c){var d=b.exec(a);return d&&(d.shift(),c&&(d=i(d))),d}function h(a,b){if("string"!=typeof a)throw new Error("Route pattern should be a string.");var c=function(a,c){var d;if(c="?"===c.substr(0,1)?c.substr(1):c,null!=b[c]){if("object"==typeof b[c]){var e=[];for(var f in b[c])e.push(encodeURI(f+"="+b[c][f]));d="?"+e.join("&")}else d=String(b[c]);if(-1===a.indexOf("*")&&-1!==d.indexOf("/"))throw new Error('Invalid value "'+d+'" for segment "'+a+'".')}else{if(-1!==a.indexOf("{"))throw new Error("The segment "+a+" is required.");d=""}return d};return n.OS.trail||(n.OS.trail=new RegExp("(?:"+n.OS.id+")+$")),a.replace(n.OS.rgx,n.OS.save).replace(m,c).replace(n.OS.trail,"").replace(n.OS.rRestore,"/")}var j=/[\\.+*?\^$\[\](){}\/'#]/g,k=/^\/|\/$/g,l=/\/$/g,m=/(?:\{|:)([^}:]+)(?:\}|:)/g,n={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},o=1,p=2,q=3,r=o;return a(),{strict:function(){r=p},loose:function(){r=o},legacy:function(){r=q},getParamIds:c,getOptionalParamsIds:d,getParamValues:g,compilePattern:e,interpolate:h}}(),m};"function"==typeof a&&a.amd?a(["signals"],d):"undefined"!=typeof c&&c.exports?c.exports=d(b("signals")):window.crossroads=d(window.signals)}()},{signals:4}],2:[function(a,b){var c=b.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){if(a.source===window&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var b=c.shift();b()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},{}],3:[function(){!function(a){function b(){}function c(a,b,d){var e=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==a||""===a||b)a=b?a:x.href,(!C||d)&&(a=a.replace(/^[^#]*/,"")||"#",a=x.protocol+"//"+x.host+N.basepath+a.replace(new RegExp("^#[/]?(?:"+N.type+")?"),""));else{var f=c(),g=f._pathname,h=f._protocol;a=""+a,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?h+a:a:h+"//"+f._host+(0===a.indexOf("/")?a:0===a.indexOf("?")?g+a:0===a.indexOf("#")?g+f._search+a:g.replace(/[^\/]+$/g,"")+a)}P.href=a;var i=e.exec(P.href),j=i[2]+(i[3]?":"+i[3]:""),k=i[4]||"/",l=i[5]||"",m="#"===i[6]?"":i[6]||"",n=k+l+m,o=k.replace(new RegExp("^"+N.basepath,"i"),N.type)+l;return{_href:i[1]+"//"+j+n,_protocol:i[1],_host:j,_hostname:i[2],_port:i[3]||"",_pathname:k,_search:l,_hash:m,_relative:n,_nohash:o,_special:o+m}}function d(){var a="";if(u)a+=u.getItem(O);else{var b=s.cookie.split(O+"=");b.length>1&&(a+=b.pop().split(";").shift()||"null")}try{T=w.parse(a)||{}}catch(c){T={}}K(G+"unload",function(){if(u)u.setItem(O,w.stringify(T));else{var a={};(a[x.href]=z.state)&&(s.cookie=O+"="+w.stringify(a))}},!1)}function e(c,d,e,f){e=e||{set:b};var g=!e.set,h=!e.get,i={configurable:!0,set:function(){g=1},get:function(){h=1}};try{E(c,d,i),c[d]=c[d],E(c,d,e)}catch(j){}if(!g||!h)if(c.__defineGetter__&&(c.__defineGetter__(d,i.get),c.__defineSetter__(d,i.set),c[d]=c[d],e.get&&c.__defineGetter__(d,e.get),e.set&&c.__defineSetter__(d,e.set)),g&&h||c!==a){if(!g||!h)try{try{var k=v.create(c);E(v.getPrototypeOf(k)===c?k:c,d,e);for(var l in c)"function"==typeof c[l]&&(k[l]=c[l].bind(c));try{f.call(k,k,c)}catch(j){}c=k}catch(j){E(c.constructor.prototype,d,e)}}catch(j){return!1}}else{try{var m=c[d];c[d]=null}catch(j){}if("execScript"in a)a.execScript("Public "+d,"VBScript");else try{E(c,d,{value:b})}catch(j){}c[d]=m}return c}function f(a,b,c){return c=c||{},a=a===Z?x:a,c.set=c.set||function(c){a[b]=c},c.get=c.get||function(){return a[b]},c}function g(a,b,c){a in U?U[a].push(b):arguments.length>3?K(a,b,c,arguments[3]):K(a,b,c)}function h(a,b,c){var d=U[a];if(d){for(var e=d.length;--e;)if(d[e]===b){d.splice(e,1);break}}else L(a,b,c)}function i(c,d){var f=(""+("string"==typeof c?c:c.type)).replace(/^on/,""),g=U[f];if(g){if(d="string"==typeof c?d:c,null==d.target)for(var h=["target","currentTarget","srcElement","type"];c=h.pop();)d=e(d,c,{get:"type"===c?function(){return f}:function(){return a}});(("popstate"===f?a.onpopstate:a.onhashchange)||b).call(a,d);for(var i=0,j=g.length;j>i;i++)g[i].call(a,d);return!0}return M(c,d)}function j(){var a=s.createEvent?s.createEvent("Event"):s.createEventObject();a.initEvent?a.initEvent("popstate",!1,!1):a.type="popstate",a.state=z.state,i(a)}function k(){S&&(S=!1,j())}function l(a,b,d,e){if(!C){var f=c(b);f._relative!==c()._relative&&(Q=e,d?x.replace("#"+f._special):x.hash=f._special)}!D&&a&&(T[x.href]=a),S=!1}function m(b){if(Q){R!==x.href&&j(),b=b||a.event;var d=c(Q,!0),e=c();b.oldURL||(b.oldURL=d._href,b.newURL=e._href),d._hash!==e._hash&&i(b)}Q=x.href}function n(a){setTimeout(function(){K("popstate",function(a){R=x.href,D||(a=e(a,"state",{get:function(){return z.state}})),i(a)},!1)},0),!C&&a!==!0&&z.location&&(q(z.location.hash),k())}function o(a){for(;a;){if("A"===a.nodeName)return a;a=a.parentNode}}function p(b){var d=b||a.event,e=o(d.target||d.srcElement),f="defaultPrevented"in d?d.defaultPrevented:d.returnValue===!1;if(e&&"A"===e.nodeName&&!f){var g=c(),h=c(e.getAttribute("href",2)),i=g._href.split("#").shift()===h._href.split("#").shift();i&&h._hash&&(g._hash!==h._hash&&(z.location.hash=h._hash),q(h._hash),d.preventDefault?d.preventDefault():d.returnValue=!1)}}function q(b){var c=s.getElementById(b=(b||"").replace(/^#/,""));if(c&&c.id===b&&"A"===c.nodeName){var d=c.getBoundingClientRect();a.scrollTo(t.scrollLeft||0,d.top+(t.scrollTop||0)-(t.clientTop||0))}}function r(){var b=s.getElementsByTagName("script"),g=(b[b.length-1]||{}).src||"",h=-1!==g.indexOf("?")?g.split("?").pop():"";h.replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){N[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});try{u=a.sessionStorage}catch(i){}K(G+"hashchange",m,!1);var j=[Z,F,W,a,Y,z];D&&delete Y.state;for(var k=0;k<j.length;k+=2)for(var l in j[k])if(j[k].hasOwnProperty(l))if("function"==typeof j[k][l])j[k+1][l]=j[k][l];else{var o=f(j[k],l,j[k][l]);if(!e(j[k+1],l,o,function(b,c){c===z&&(a.history=z=j[k+1]=b)}))return L(G+"hashchange",m,!1),!1;j[k+1]===a&&(U[l]=U[l.substr(2)]=[])}return N.redirect&&z.redirect(),!D&&w&&d(),C||s[H](G+"click",p,!1),"complete"===s.readyState?n(!0):(C||c()._relative===N.basepath||(S=!0),K(G+"load",n,!1)),!0}if(a.history){var s=a.document,t=s.documentElement,u=null,v=a.Object,w=a.JSON,x=a.location,y=a.history,z=y,A=y.pushState,B=y.replaceState,C=!!A,D="state"in y,E=v.defineProperty,F=e({},"t")?{}:s.createElement("a"),G="",H=a.addEventListener?"addEventListener":(G="on")&&"attachEvent",I=a.removeEventListener?"removeEventListener":"detachEvent",J=a.dispatchEvent?"dispatchEvent":"fireEvent",K=a[H],L=a[I],M=a[J],N={basepath:"/",redirect:0,type:"/"},O="__historyAPI__",P=s.createElement("a"),Q=x.href,R="",S=!1,T={},U={},V=s.title,W={onhashchange:null,onpopstate:null},X=function(b,c){var d=a.history!==y;d&&(a.history=y),b.apply(y,c),d&&(a.history=z)},Y={redirect:function(b,d){if(N.basepath=d=null==d?N.basepath:d,N.type=b=null==b?N.type:b,a.top==a.self){var e=c(null,!1,!0)._relative,f=x.pathname+x.search;C?(f=f.replace(/([^\/])$/,"$1/"),e!=d&&new RegExp("^"+d+"$","i").test(f)&&x.replace(e)):f!=d&&(f=f.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+d,"i").test(f)&&x.replace(d+"#"+f.replace(new RegExp("^"+d,"i"),b)+x.hash))}},pushState:function(a,b,c){var d=s.title;null!=V&&(s.title=V),A&&X(A,arguments),l(a,c),s.title=d,V=b},replaceState:function(a,b,c){var d=s.title;null!=V&&(s.title=V),delete T[x.href],B&&X(B,arguments),l(a,c,!0),s.title=d,V=b},location:{set:function(b){a.location=b},get:function(){return C?x:F}},state:{get:function(){return T[x.href]||null}}},Z={assign:function(a){0===(""+a).indexOf("#")?l(null,a):x.assign(a)},reload:function(){x.reload()},replace:function(a){0===(""+a).indexOf("#")?l(null,a,!0):x.replace(a)},toString:function(){return this.href},href:{get:function(){return c()._href}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return c()._pathname}},search:{get:function(){return c()._search}},hash:{set:function(a){l(null,(""+a).replace(/^(#|)/,"#"),!1,Q)},get:function(){return c()._hash}}};r()&&(z.emulate=!C,a[H]=g,a[I]=h,a[J]=i)}}(window)},{}],4:[function(b,c){!function(b){function d(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function e(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function f(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){f.prototype.dispatch.apply(a,arguments)}}d.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},f.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,e){var f,g=this._indexOfListener(a,c);if(-1!==g){if(f=this._bindings[g],f.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else f=new d(this,a,b,c,e),this._addBinding(f);return this.memorize&&this._prevParams&&f.execute(this._prevParams),f},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){return e(a,"add"),this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return e(a,"addOnce"),this._registerListener(a,!0,b,c)},remove:function(a,b){e(a,"remove");var c=this._indexOfListener(a,b);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var a,b=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=b),c){a=this._bindings.slice(),this._shouldPropagate=!0;do c--;while(a[c]&&this._shouldPropagate&&a[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var g=f;g.Signal=f,"function"==typeof a&&a.amd?a(function(){return g}):"undefined"!=typeof c&&c.exports?c.exports=g:b.signals=g}(this)},{}],5:[function(b,c){var d=b("__browserify_process");!function(a,b){"use strict";a(function(a){function c(a,b,c,d){return e(a).then(b,c,d)}function e(a){return a instanceof f?a:g(a)}function f(a,b){this._message=a,this.inspect=b}function g(a){return j(function(b){b(a)})}function h(a){return c(a,n)}function i(){function a(a,e,f){b.resolve=b.resolver.resolve=function(b){return d?g(b):(d=!0,a(b),c)},b.reject=b.resolver.reject=function(a){return d?g(n(a)):(d=!0,e(a),c)},b.notify=b.resolver.notify=function(a){return f(a),a}}var b,c,d;return b={promise:W,resolve:W,reject:W,notify:W,resolver:{resolve:W,reject:W,notify:W}},b.promise=c=j(a),b}function j(a){return k(a,T.PromiseStatus&&T.PromiseStatus())}function k(a,b){function c(a,b,c,d){function e(e){e._message(a,b,c,d)}k?k.push(e):H(function(){e(j)})}function d(){return j?j.inspect():G()}function e(a){if(k){var c=k;k=W,H(function(){j=q(i,a),b&&u(j,b),l(c,j)})}}function g(a){e(n(a))}function h(a){if(k){var b=k;H(function(){l(b,p(a))})}}var i,j,k=[];i=new f(c,d),i._status=b;try{a(e,g,h)}catch(m){g(m)}return i}function l(a,b){for(var c=0;c<a.length;c++)a[c](b)}function m(a){return o(new s(a),function(){return E(a)})}function n(a){return o(new t(a),function(){return F(a)})}function o(a,b){return new f(function(b,c,d){try{d(a[b].apply(a,c))}catch(e){d(n(e))}},b)}function p(a){return new f(function(b,c,d,e){var f=c[2];try{e("function"==typeof f?f(a):a)}catch(g){e(g)}})}function q(a,b){if(b===a)return n(new TypeError);if(b instanceof f)return b;try{var c=b===Object(b)&&b.then;return"function"==typeof c?r(c,b):m(b)}catch(d){return n(d)}}function r(a,b){return j(function(c,d){M(a,b,c,d)})}function s(a){this.value=a}function t(a){this.reason=a}function u(a,b){function c(){b.fulfilled()}function d(a){b.rejected(a)}a.then(c,d)}function v(a){return a&&"function"==typeof a.then}function w(a,b,d,e,f){return c(a,function(a){function g(d,e,f){function g(a){n(a)}function h(a){m(a)}var i,j,k,l,m,n,o,p;if(o=a.length>>>0,i=Math.max(0,Math.min(b,o)),k=[],j=o-i+1,l=[],i)for(n=function(a){l.push(a),--j||(m=n=J,e(l))},m=function(a){k.push(a),--i||(m=n=J,d(k))},p=0;o>p;++p)p in a&&c(a[p],h,g,f);else d(k)}return j(g).then(d,e,f)})}function x(a,b,c,d){function e(a){return b?b(a[0]):a[0]}return w(a,1,e,c,d)}function y(a,b,c,d){return C(a,J).then(b,c,d)}function z(){return C(arguments,J)}function A(a){return C(a,E,F)}function B(a,b){return C(a,b)}function C(a,b,d){return c(a,function(a){function e(e,f,g){function h(a,h){c(a,b,d).then(function(a){i[h]=a,--k||e(i)},f,g)}var i,j,k,l;if(k=j=a.length>>>0,i=[],!k)return e(i),void 0;for(l=0;j>l;l++)l in a?h(a[l],l):--k}return k(e)})}function D(a,b){var d=M(L,arguments,1);return c(a,function(a){var e;return e=a.length,d[0]=function(a,d,f){return c(a,function(a){return c(d,function(c){return b(a,c,f,e)})})},K.apply(a,d)})}function E(a){return{state:"fulfilled",value:a}}function F(a){return{state:"rejected",reason:a}}function G(){return{state:"pending"}}function H(a){1===O.push(a)&&N(I)}function I(){l(O),O=[]}function J(a){return a}c.promise=j,c.resolve=g,c.reject=h,c.defer=i,c.join=z,c.all=y,c.map=B,c.reduce=D,c.settle=A,c.any=x,c.some=w,c.isPromise=v,c.isPromiseLike=v,f.prototype={then:function(){var a,b;return a=arguments,b=this._message,k(function(c,d,e){b("when",a,c,e)},this._status&&this._status.observed())},otherwise:function(a){return this.then(W,a)},ensure:function(a){function b(){return g(a())}return"function"==typeof a?this.then(b,b).yield(this):this},yield:function(a){return this.then(function(){return a})},tap:function(a){return this.then(a).yield(this)},spread:function(a){return this.then(function(b){return y(b,function(b){return a.apply(W,b)})})},always:function(a,b){return this.then(a,a,b)}},s.prototype.when=function(a){return"function"==typeof a?a(this.value):this.value},t.prototype.when=function(a,b){if("function"==typeof b)return b(this.reason);throw this.reason};var K,L,M,N,O,P,Q,R,S,T,U,V,W;if(U=a,O=[],P=b.setTimeout,T="undefined"!=typeof console?console:c,"object"==typeof d&&d.nextTick)N=d.nextTick;else if(V=b.MutationObserver||b.WebKitMutationObserver)N=function(a,b,c){var d=a.createElement("div");return new b(c).observe(d,{attributes:!0}),function(){d.setAttribute("x","x")}}(document,V,I);else try{N=U("vertx").runOnLoop||U("vertx").runOnContext}catch(X){N=function(a){P(a,0)}}return Q=Function.prototype,R=Q.call,M=Q.bind?R.bind(R):function(a,b){return a.apply(b,L.call(arguments,2))},S=[],L=S.slice,K=S.reduce||function(a){var b,c,d,e,f;if(f=0,b=Object(this),e=b.length>>>0,c=arguments,c.length<=1)for(;;){if(f in b){d=b[f++];break}if(++f>=e)throw new TypeError}else d=c[1];for(;e>f;++f)f in b&&(d=a(d,b[f],f,b));return d},c})}("function"==typeof a&&a.amd?a:function(a){c.exports=a(b)},this)},{__browserify_process:2}],6:[function(a,b){"use strict";function c(a){function b(a,b){if(!o(a,b)){var c,d=g(a,b);I?(l(),c=g(I.currentState,I.toParams)):c=H,H=d,m(c,d),I=h(c,d,p(c&&c.params,b)),I.then(function(){var a;I=null,L||Q||(a=("/"+G).replace("//","/"),j("Pushing state: {0}",a),history.pushState(a,document.title,a)),n(c,d)},function(a){I=null,H=c,k("Transition from {0} to {1} failed: {2}",c,d,a),N.transition.failed.dispatch(d,c)})}}function l(){j("Cancelling existing transition from {0} to {1}",I.from,I.to),I.cancel(),N.transition.cancelled.dispatch(I.to,I.from)}function m(a,b){j("Starting transition from {0} to {1}",a,b),N.transition.started.dispatch(b,a)}function n(a,b){j("Transition from {0} to {1} completed",a,b),N.transition.completed.dispatch(b,a),Q=!1}function o(a,b){var c,d,e;return I?(c=I.to,d=I.toParams):H&&(c=H._state,d=H.params),e=p(d,b),a==c&&0==i.objectSize(e)}function p(a,b){var c={},a=a||{};for(var d in a)a[d]!=b[d]&&(c[d]=1);for(var d in b)a[d]!=b[d]&&(c[d]=1);return c}function q(a){if(j("State not found: {0}",a),!O.notFound)throw new Error('State "'+a+'" could not be found');b(O.notFound)}function r(a){return i.mergeObjects(R,a),N}function s(a){R.enableLogs&&c.enableLogs(),R.interceptAnchorClicks&&f(N),j("Router init"),t();var b=!c.ignoreInitialURL&&B()||a||"";return j("Initializing to state {0}",b||'""'),w(b),window.onpopstate=function(a){var b=a.state||B();j("Popped state: {0}",b),L=!0,y(b)},M=!0,N}function t(){u(function(a,b){b.init(a)}),J={},v(function(a){J[a.fullName]=a,a.route=P.addRoute(a.fullPath()+":?query:"),a.route.matched.add(function(){K=!0,b(a,C(a,arguments))})})}function u(a){for(var b in O)a(b,O[b])}function v(a){function b(c){c.forEach(function(c){c.children.length?b(c.children):a(c)})}b(i.objectToArray(O))}function w(a,b){var c=a.indexOf(".")>-1||J[a];j("Changing state to {0}",a||'""'),L=!1,c?z(a,b||{}):y(a)}function x(a,b){j("Redirecting..."),w(a,b)}function y(a){G=a,K=!1,P.parse(a),K||q(a)}function z(a,b){var c=J[a];if(!c)return q(a);var d=c.route.interpolate(b);y(d)}function A(a,b){if(M)throw new Error("States can only be added before the Router is initialized");if(O[a])throw new Error("A state already exist in the router with the name "+a);return j("Adding state {0}",a),O[a]=b,N}function B(){var a=location.href.indexOf("#/");return a>-1?location.href.slice(a+2):(location.pathname+location.search).slice(1)}function C(a,b){var c,d=Array.prototype.slice.apply(b),e=d.pop(),f={};a.fullPath().replace(/\{\w*\}/g,function(a){return c=a.slice(1,-1),f[c]=d.shift(),""}),e&&i.mergeObjects(f,e);for(var g in f)i.isString(f[g])&&(f[g]=decodeURIComponent(f[g]));return f}function D(a,b){var c={},d={},e=!1,f=J[a];if(!f)throw new Error("Cannot find state "+a);[f].concat(f.parents).forEach(function(a){i.mergeObjects(d,a.queryParams)});for(var g in b)d[g]&&(c[g]=b[g],delete b[g],e=!0);return e&&(b.query=c),"/"+f.route.interpolate(b).replace("/?","?")}function E(){return H}function F(a,b){N.transition.ended.dispatch(a,b)}var G,H,I,J,K,L,M,N={},O=i.copyObject(a),P=e.create(),Q=!0,R={enableLogs:!1,interceptAnchorClicks:!0};return P.shouldTypecast=!0,P.ignoreState=!0,N.configure=r,N.init=s,N.state=w,N.redirect=x,N.addState=A,N.link=D,N.currentState=E,N.transition={started:new d,ended:new d,completed:new d,failed:new d,cancelled:new d},N.initialized=new d,N.changed=N.transition.completed,N.transition.completed.addOnce(function(){N.initialized.dispatch()}),N.transition.completed.add(F),N.transition.failed.add(F),N.transition.cancelled.add(F),N}var d=a("signals").Signal,e=a("crossroads"),f=a("./anchorClicks"),g=a("./StateWithParams"),h=a("./Transition"),i=a("./util"),j=i.noop,k=i.noop;c.enableLogs=function(){function a(a){for(var b=a[0],c=Array.prototype.slice.call(a,1),d=0,e=c.length;e>d;d++)b=b.replace("{"+d+"}",c[d]);return b}j=function(){console.log(a(arguments))},k=function(){console.error(a(arguments))}},b.exports=c},{"./StateWithParams":8,"./Transition":9,"./anchorClicks":10,"./util":12,crossroads:1,signals:4}],7:[function(a,b){"use strict";function c(){function a(a,b){p.name=a,p.parent=b,p.parents=c(),p.children=g(),p.fullName=i(),p.root=p.parents[p.parents.length-1],p.async=f,l(function(a,b){b.init(a,p)}),o=!0}function b(){for(var a=p.path,b=p.parent;b;)b.path&&(a=b.path+"/"+a),b=b.parent;return a}function c(){for(var a=[],b=p.parent;b;)a.push(b),b=b.parent;return a}function g(){var a=[];for(var b in s)a.push(s[b]);return a}function h(a){var b={};for(var c in a)a[c]._isState&&(b[c]=a[c]);return b}function i(){return p.parents.reduceRight(function(a,b){return a+b.name+"."},"")+p.name}function j(a){var b={enter:1,exit:1,enterPrereqs:1,exitPrereqs:1},c={};for(var d in a)b[d]||a[d]._isState||(c[d]=a[d]);return c}function k(a,b){if(void 0!==b){if(void 0!==p.ownData[a])throw new Error("State "+p.fullName+" already has data with the key "+a);return p.ownData[a]=b,p}for(var c=p;void 0===c.ownData[a]&&c.parent;)c=c.parent;return c.ownData[a]}function l(a){for(var b in s)a(b,s[b])}function m(a,b){if(o)throw new Error("States can only be added before the Router is initialized");if(s[a])throw new Error("The state {0} already has a child state named {1}".replace("{0}",p.name).replace("{1}",a));return s[a]=b,p}function n(){return p.fullName}var o,p={_isState:!0},q=d(arguments),r=q.options,s=h(q.options);return p.path=q.path,p.params=q.params,p.queryParams=q.queryParams,p.states=s,p.enter=r.enter||e.noop,p.exit=r.exit||e.noop,p.enterPrereqs=r.enterPrereqs,p.exitPrereqs=r.exitPrereqs,p.ownData=j(r),p.init=a,p.fullPath=b,p.data=k,p.addState=m,p.toString=n,p}function d(a){var b,c,d={path:"",options:{},params:{},queryParams:{}},f=a[0],g=a[1];return 1==a.length?e.isString(f)?d.path=f:d.options=f:2==a.length&&(d.path=f,d.options="object"==typeof g?g:{enter:g}),b=d.path.indexOf("?"),-1!=b&&(d.queryParams=d.path.slice(b+1),d.path=d.path.slice(0,b),d.queryParams=e.arrayToObject(d.queryParams.split("&"))),d.path=d.path.replace(/:\w*/g,function(a){return c=a.substring(1),d.params[c]=1,"{"+c+"}"}),d}var e=a("./util"),f=a("./Transition").asyncPromises.register;b.exports=c},{"./Transition":9,"./util":12}],8:[function(a,b){"use strict";function c(a,b){return{_state:a,name:a&&a.name,fullName:a&&a.fullName,data:a&&a.data,params:b,is:d,isIn:e,toString:f}}function d(a){return this.fullName==a}function e(a){for(var b=this._state;b;){if(b.fullName==a)return!0;b=b.parent}return!1}function f(){return this.fullName+":"+JSON.stringify(this.params)}b.exports=c},{}],9:[function(a,b){"use strict";function c(a,b,c){function g(a,b){return n.then(function(){l||a()},function(a){l||b(a)})}function i(){l=t.cancelled=!0}var k,l,m,n,o=[],p=a&&a._state,q=b._state,r=b.params,s=p==q,t={from:p,to:q,toParams:r,then:g,cancel:i,cancelled:l,currentState:p};return p&&(k=f(p,q,s,c),o=h(p,k,s)),m=h(q,k,s).reverse(),n=d(m,o,r).then(function(){l||e(m,o,r,t)}),j.newTransitionStarted(),t}function d(a,b,c){return b.forEach(function(a){if(a.exitPrereqs)var b=a._exitPrereqs=i(a.exitPrereqs()).then(function(c){a._exitPrereqs==b&&(a._exitPrereqs.value=c)},function(){throw new Error("Failed to resolve EXIT prereqs of "+a.fullName)})}),a.forEach(function(a){if(a.enterPrereqs)var b=a._enterPrereqs=i(a.enterPrereqs(c)).then(function(c){a._enterPrereqs==b&&(a._enterPrereqs.value=c)},function(){throw new Error("Failed to resolve ENTER prereqs of "+a.fullName)})}),i.all(a.concat(b).map(function(a){return a._enterPrereqs||a._exitPrereqs}))}function e(a,b,c,d){b.forEach(function(a){a.exit(a._exitPrereqs&&a._exitPrereqs.value)}),j.allowed=!0,a.forEach(function(a){d.cancelled||(d.currentState=a,a.enter(c,a._enterPrereqs&&a._enterPrereqs.value))}),j.allowed=!1}function f(a,b,c,d){var e,f,g;if(c)a.parents.slice().reverse().forEach(function(a){for(g in d)if(a.params[g]||a.queryParams[g]){e=a;break}});else for(var h=0;h<a.parents.length;h++)if(f=a.parents[h],b.parents.indexOf(f)>-1){e=f;break}return e}function g(a,b,c){var d=a.parents,e=Math.min(d.length,d.indexOf(b)+(c?1:0));return[a].concat(d.slice(0,e))}function h(a,b,c){var d=!b||c;return g(a,b||a.root,d)}var i=a("when"),j=c.asyncPromises=function(){function a(a){if(!c.allowed)throw new Error("Async can only be called from within state.enter()");var b=i.defer();return d.push(b),i(a).then(function(a){d.indexOf(b)>-1&&b.resolve(a)},function(a){d.indexOf(b)>-1&&b.reject(a)}),b.promise}function b(){d.length=0}var c,d=[];return c={register:a,newTransitionStarted:b,allowed:!1}}();b.exports=c},{when:5}],10:[function(a,b){"use strict";function c(a){a=a||window.event;var b="defaultPrevented"in a?a.defaultPrevented:a.returnValue===!1;if(!(b||a.metaKey||a.ctrlKey)&&d(a)){var c=a.target||a.srcElement,f=e(c);if(f){var h=f.getAttribute("href");"#"!=h.charAt(0)&&"_blank"!=f.getAttribute("target")&&g(f)&&(a.preventDefault?a.preventDefault():a.returnValue=!1,router.state(h))}}}function d(a){a=a||window.event;var b=void 0!==a.which?a.which:h;return 1==b}function e(a){for(;a;){if("A"==a.nodeName)return a;
a=a.parentNode}}function f(a){h=(a||window.event).button}function g(a){var b=a.hostname,c=a.port;if(!b){var d=document.createElement("a");d.href=a.href,b=d.hostname,c=d.port}var e=b==location.hostname,f=(c||"80")==(location.port||"80");return e&&f}var h;b.exports=function(){document.addEventListener?document.addEventListener("click",c):(document.attachEvent("onmousedown",f),document.attachEvent("onclick",c))}},{}],11:[function(a,b){"use strict";a("html5-history-api/history.iegte8");var c={Router:a("./Router"),State:a("./State"),Async:a("./Transition").asyncPromises.register};b.exports=c},{"./Router":6,"./State":7,"./Transition":9,"html5-history-api/history.iegte8":3}],12:[function(a,b){"use strict";function c(a){return"[object String]"==Object.prototype.toString.call(a)}function d(){}function e(a){return a.reduce(function(a,b){return a[b]=1,a},{})}function f(a){var b=[];for(var c in a)b.push(a[c]);return b}function g(a){var b={};for(var c in a)b[c]=a[c];return b}function h(a,b){for(var c in b)a[c]=b[c]}function i(a){var b=0;for(var c in a)b++;return b}b.exports={isString:c,noop:d,arrayToObject:e,objectToArray:f,copyObject:g,mergeObjects:h,objectSize:i}},{}]},{},[11])(11)});